document.addEventListener("DOMContentLoaded",()=>{let e={inputArea:document.getElementById("input-area"),outputArea:document.getElementById("output-area"),fromBaseSelect:document.getElementById("from-base-select"),toBaseSelect:document.getElementById("to-base-select"),themeToggle:document.getElementById("theme-toggle"),swapBtn:document.getElementById("swap-btn"),body:document.body},t={Numerical:{toBigInt(e,t){let a=parseInt(t),r=e.toLowerCase();if(""===r.trim())return 0n;let l=0n;for(let o of r){if("."===o)throw Error("Decimal points ('.') are not supported in this version.");let i="0123456789abcdef".indexOf(o);if(-1===i||i>=a)throw Error(`The character '${o.toUpperCase()}' is not a valid digit for Base-${a}.`);l=l*BigInt(a)+BigInt(i)}return l},fromBigInt(e,t){let a=parseInt(t);return e.toString(a).toUpperCase()}},Text:{toCharCodes(e){let t=[];for(let a=0;a<e.length;a++)t.push(e.charCodeAt(a));return t},fromCharCodes:e=>String.fromCodePoint(...e)}};function a(){let{inputArea:a,outputArea:r,fromBaseSelect:l,toBaseSelect:o}=e,i=a.value,n=l.value,s=o.value;if(""===i.trim()){r.value="",r.style.color="";return}if(n===s){r.value="TIP: Source and target bases cannot be the same.",r.style.color="var(--warning-color)";return}try{let c="";if("text"===n){let d=t.Text.toCharCodes(i);c=d.map(e=>t.Numerical.fromBigInt(BigInt(e),s)).join(" ")}else if("text"===s){let u=i.trim().split(/\s+/),m=u.map(e=>Number(t.Numerical.toBigInt(e,n)));c=t.Text.fromCharCodes(m)}else{let g=t.Numerical.toBigInt(i.replace(/\s/g,""),n);if(c=t.Numerical.fromBigInt(g,s),"2"===s){let v=c.padStart(4*Math.ceil(c.length/4),"0");c=v.replace(/(.{4})/g,"$1 ").trim()}}r.value=c,r.style.color=""}catch(p){let h;p instanceof RangeError?h="INVALID NUMBER: One or more values are too large to be a valid character code.":p.message.includes("not a valid digit")?h=`INVALID INPUT: ${p.message}`:(console.error("An unexpected error occurred:",p),h="ERROR: Please check your input for typos or invalid characters."),r.value=h,r.style.color="var(--error-color)"}}[e.inputArea,e.fromBaseSelect,e.toBaseSelect].forEach(e=>{e.addEventListener("input",a),e.addEventListener("change",a)}),e.swapBtn.addEventListener("click",()=>{let{inputArea:t,outputArea:r,fromBaseSelect:l,toBaseSelect:o}=e,i=l.value;l.value=o.value,o.value=i,t.value=r.value.startsWith("ERROR:")||r.value.startsWith("TIP:")||r.value.startsWith("INVALID")?"":r.value,a()});let r=localStorage.getItem("theme");"dark"===r&&e.body.classList.add("dark"),e.themeToggle.addEventListener("click",()=>{e.body.classList.toggle("dark"),localStorage.setItem("theme",e.body.classList.contains("dark")?"dark":"light")}),document.querySelectorAll(".copy-btn").forEach(e=>{e.addEventListener("click",()=>{let t=e.dataset.target,a=document.getElementById(t);a.value&&!a.style.color&&navigator.clipboard.writeText(a.value).then(()=>{e.classList.add("copied"),setTimeout(()=>e.classList.remove("copied"),1500)})})}),document.querySelector(".paste-btn")?.addEventListener("click",()=>{navigator.clipboard.readText().then(t=>{e.inputArea.value=t,a()}).catch(e=>{console.error("Failed to read clipboard: ",e)})}),document.querySelector(".clear-btn")?.addEventListener("click",()=>{e.inputArea.value="",a()}),a()});
